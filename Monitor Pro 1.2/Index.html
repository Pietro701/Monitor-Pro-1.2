<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Monitor Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f1115">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" href="icon-192.png">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- SheetJS (XLSX) -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

  <style>
    .custom-scrollbar::-webkit-scrollbar { width: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
  </style>
</head>

<body class="bg-[#0f1115] text-gray-200">
  <div id="root"></div>

  <script>
    // Service Worker (PWA)
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => navigator.serviceWorker.register("./sw.js"));
    }
  </script>

  <script>
    const { useState, useEffect, useMemo, useRef } = React;

    // --- Utility per calcolo minuti ---
    const timeToMinutes = (timeStr) => {
      if (!timeStr) return 0;
      const [h, m] = timeStr.split(':').map(Number);
      return h * 60 + m;
    };

    const minutesToTime = (mins) => {
      const h = Math.floor((mins % 1440) / 60);
      const m = Math.floor(mins % 60);
      return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}`;
    };

    // --- Badge Component ---
    const Badge = ({ type, value }) => {
      let colorClass = "bg-gray-800 text-gray-400";
      if (type === 'model') {
        if (value === 'L74') colorClass = "bg-red-900/30 text-red-400 border border-red-800/30";
        if (value === 'D74') colorClass = "bg-blue-900/30 text-blue-400 border border-blue-800/30";
      } else if (type === 'fuel') {
        if (value === 'BEV') colorClass = "bg-emerald-900/30 text-emerald-400 border border-emerald-800/30";
        if (value === 'MHEV') colorClass = "bg-yellow-900/30 text-yellow-400 border border-yellow-800/30";
      }
      return React.createElement(
        "span",
        { className: `px-1.5 py-0.5 rounded text-[9px] font-black uppercase tracking-tighter border ${colorClass}` },
        value
      );
    };

    function App() {
      const fileInputRef = useRef(null);

      // --- State Management ---
      const [target, setTarget] = useState(300);
      const [shiftConfig, setShiftConfig] = useState({
        start: '06:00',
        end: '13:30',
        breaks: [
          { time: '08:00', duration: 10 },
          { time: '10:00', duration: 10 },
          { time: '12:00', duration: 10 }
        ]
      });
      const [showConfig, setShowConfig] = useState(false);
      const [currentTime, setCurrentTime] = useState(new Date());
      const [records, setRecords] = useState([]);

      // Stati separati per Glazing e CH3
      const [activeCalc, setActiveCalc] = useState('GLAZING');
      const [glazingData, setGlazingData] = useState({ start: '', end: '' });
      const [ch3Data, setCh3Data] = useState({ start: '', end: '' });

      const [formData, setFormData] = useState({
        id: null,
        seq: '',
        vettura: '',
        modello: 'D74',
        alimentazione: 'BEV',
        difetti: '' // ✅ nuovo campo
      });

      const [notification, setNotification] = useState(null);

      useEffect(() => {
        const savedRecords = localStorage.getItem('db_monitor_records');
        const savedTarget = localStorage.getItem('db_monitor_target');
        const savedShift = localStorage.getItem('db_monitor_shift');

        if (savedRecords) {
          const parsed = JSON.parse(savedRecords);
          setRecords(parsed.sort((a, b) => b.seq - a.seq).slice(0, 500));
        }
        if (savedTarget) setTarget(parseInt(savedTarget));
        if (savedShift) setShiftConfig(JSON.parse(savedShift));

        const timer = setInterval(() => setCurrentTime(new Date()), 30000);
        return () => clearInterval(timer);
      }, []);

      useEffect(() => {
        localStorage.setItem('db_monitor_records', JSON.stringify(records));
      }, [records]);

      useEffect(() => {
        localStorage.setItem('db_monitor_target', String(target));
        localStorage.setItem('db_monitor_shift', JSON.stringify(shiftConfig));
      }, [target, shiftConfig]);

      useEffect(() => {
        const isMorning = shiftConfig.start === '06:00';
        setShiftConfig(prev => ({
          ...prev,
          end: isMorning ? '13:30' : '21:30',
          breaks: isMorning
            ? [{ time: '08:00', duration: 10 }, { time: '10:00', duration: 10 }, { time: '12:00', duration: 10 }]
            : [{ time: '16:00', duration: 10 }, { time: '18:00', duration: 10 }, { time: '20:00', duration: 10 }]
        }));
      }, [shiftConfig.start]);

      const shiftMetrics = useMemo(() => {
        const startMins = timeToMinutes(shiftConfig.start);
        let endMins = timeToMinutes(shiftConfig.end);
        if (endMins <= startMins) endMins += 1440;
        const totalBreak = shiftConfig.breaks.reduce((a, b) => a + (parseInt(b.duration) || 0), 0);
        return { startMins, endMins, netWork: (endMins - startMins) - totalBreak };
      }, [shiftConfig]);

      const kpi = useMemo(() => {
        const minPerCar = shiftMetrics.netWork / target;
        return {
          vOra: (60 / minPerCar).toFixed(1),
          takt: `${Math.floor(minPerCar)}:${String(Math.round((minPerCar % 1) * 60)).padStart(2, '0')}`,
          minPerCar
        };
      }, [target, shiftMetrics]);

      // --- Calcolo previsionale (rispetta pause) ---
      const getPrediction = (calcData) => {
        const s = parseInt(calcData.start);
        const e = parseInt(calcData.end);
        if (isNaN(s) || isNaN(e) || e <= s) return null;

        const count = e - s;
        const netMinutesNeeded = count * kpi.minPerCar;

        let finishMins = (currentTime.getHours() * 60) + currentTime.getMinutes();
        let remainingNet = netMinutesNeeded;

        let iterations = 0;
        while (remainingNet > 0 && iterations < 1440) {
          finishMins++;
          const currentDayMins = finishMins % 1440;

          const isInBreak = shiftConfig.breaks.some(b => {
            const bStart = timeToMinutes(b.time);
            const bEnd = bStart + parseInt(b.duration);
            return currentDayMins >= bStart && currentDayMins < bEnd;
          });

          if (!isInBreak) remainingNet -= 1;
          iterations++;
        }

        return {
          duration: `${Math.floor(netMinutesNeeded / 60)}h ${Math.round(netMinutesNeeded % 60)}m`,
          eta: minutesToTime(finishMins)
        };
      };

      const currentPrediction = useMemo(() => {
        return activeCalc === 'GLAZING' ? getPrediction(glazingData) : getPrediction(ch3Data);
      }, [activeCalc, glazingData, ch3Data, kpi, shiftConfig.breaks, currentTime]);

      const live = useMemo(() => {
        const nowMins = currentTime.getHours() * 60 + currentTime.getMinutes();
        let currentAdj = (shiftMetrics.startMins > 720 && nowMins < 720) ? nowMins + 1440 : nowMins;

        let remMins = Math.max(0, shiftMetrics.endMins - currentAdj);
        if (currentAdj < shiftMetrics.startMins) remMins = shiftMetrics.endMins - shiftMetrics.startMins;

        const futureBreaks = shiftConfig.breaks.reduce((acc, b) => {
          let bTime = timeToMinutes(b.time);
          if (shiftMetrics.startMins > 720 && bTime < 720) bTime += 1440;
          return (bTime > currentAdj && bTime < shiftMetrics.endMins) ? acc + (parseInt(b.duration) || 0) : acc;
        }, 0);

        const netRem = Math.max(0, remMins - futureBreaks);
        return {
          timeStr: `${Math.floor(remMins / 60)}h ${remMins % 60}m`,
          carsRem: Math.ceil(netRem / kpi.minPerCar),
          isOver: remMins <= 0
        };
      }, [currentTime, shiftMetrics, kpi, shiftConfig.breaks]);

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!formData.seq || !formData.vettura) return;

        const now = new Date();
        const payload = {
          ...formData,
          difetti: formData.difetti || "",
          seq: parseInt(formData.seq),
          id: formData.id || Date.now(),
          timestamp: formData.id ? formData.timestamp : now.getTime(),
          oraRegistrazione: formData.id ? formData.oraRegistrazione : now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
          dataRegistrazione: formData.id ? formData.dataRegistrazione : now.toLocaleDateString()
        };

        setRecords(prev => {
          const newRecords = formData.id
            ? prev.map(r => r.id === payload.id ? payload : r)
            : [payload, ...prev];

          return [...newRecords].sort((a, b) => b.seq - a.seq).slice(0, 500);
        });

        setNotification(formData.id ? "Modificato" : "Salvato");
        setTimeout(() => setNotification(null), 2000);

        setFormData({
          id: null,
          seq: '',
          vettura: '',
          modello: 'D74',
          alimentazione: 'BEV',
          difetti: ''
        });
      };

      const handleImportExcel = (e) => {
        const file = e.target.files && e.target.files[0];
        if (!file || !window.XLSX) return;

        const reader = new FileReader();
        reader.onload = (evt) => {
          const bstr = evt.target.result;
          const wb = window.XLSX.read(bstr, { type: 'binary' });
          const ws = wb.Sheets[wb.SheetNames[0]];
          const data = window.XLSX.utils.sheet_to_json(ws, { header: 1 });
          if (data.length < 2) return;

          const headers = data[0].map(h => String(h).toLowerCase().trim());
          const idx = {
            seq: headers.findIndex(h => h.includes('seq') || h.includes('sequenza')),
            vettura: headers.findIndex(h => h.includes('vettura') || h.includes('vin')),
            modello: headers.findIndex(h => h.includes('modello')),
            alim: headers.findIndex(h => h.includes('alim') || h.includes('aliment')),
            difetti: headers.findIndex(h => h.includes('difett') || h.includes('note') || h.includes('annot'))
          };

          const imported = data.slice(1).map((row, i) => ({
            id: Date.now() + i,
            seq: parseInt(row[idx.seq]) || 0,
            vettura: String(row[idx.vettura] || '').toUpperCase(),
            modello: row[idx.modello] || 'D74',
            alimentazione: row[idx.alim] || 'BEV',
            difetti: idx.difetti >= 0 ? String(row[idx.difetti] || '') : '',
            timestamp: Date.now(),
            oraRegistrazione: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
            dataRegistrazione: new Date().toLocaleDateString()
          })).filter(r => r.seq > 0);

          setRecords(prev => {
            const combined = [...imported, ...prev];
            return combined.sort((a, b) => b.seq - a.seq).slice(0, 500);
          });

          setNotification(`Caricati ${imported.length} record`);
          setTimeout(() => setNotification(null), 2200);
        };

        reader.readAsBinaryString(file);
        e.target.value = '';
      };

      // ✅ EXPORT .XLSX VERO (con Difetti)
      const exportToExcel = () => {
        if (records.length === 0 || !window.XLSX) return;

        const aoa = [
          ["Sequenza", "Vettura", "Modello", "Alimentazione", "Difetti", "Data", "Ora"],
          ...records.map(r => [
            r.seq,
            r.vettura,
            r.modello,
            r.alimentazione,
            r.difetti || "",
            r.dataRegistrazione,
            r.oraRegistrazione
          ])
        ];

        const ws = window.XLSX.utils.aoa_to_sheet(aoa);
        ws["!cols"] = [
          { wch: 10 }, // Sequenza
          { wch: 22 }, // Vettura
          { wch: 10 }, // Modello
          { wch: 14 }, // Alimentazione
          { wch: 38 }, // Difetti
          { wch: 14 }, // Data
          { wch: 8 }   // Ora
        ];
        ws["!autofilter"] = { ref: `A1:G${aoa.length}` };

        const wb = window.XLSX.utils.book_new();
        window.XLSX.utils.book_append_sheet(wb, ws, "Report");

        const fileName = `MonitorPro_${new Date().toISOString().split('T')[0]}.xlsx`;
        window.XLSX.writeFile(wb, fileName);
      };

      return React.createElement(
        "div",
        { className: "min-h-screen bg-[#0f1115] text-gray-200 font-sans p-3 pb-20 select-none" },
        React.createElement("div", { className: "max-w-md mx-auto space-y-3" },

          /* Header */
          React.createElement("div", { className: "flex items-center justify-between px-1" },
            React.createElement("div", { className: "flex items-center gap-1.5" },
              React.createElement("div", { className: "p-1 bg-teal-500/20 rounded-lg" },
                React.createElement("div", { className: "w-4 h-4 bg-teal-400/80 rounded" })
              ),
              React.createElement("div", null,
                React.createElement("h1", { className: "text-sm font-black tracking-tighter text-white uppercase leading-none" },
                  "Monitor Pro ", React.createElement("span", { className: "text-yellow-400" }, "by Pietro")
                ),
                React.createElement("span", { className: "text-[8px] text-teal-500/50 font-bold uppercase tracking-widest" }, "Installabile (PWA)")
              )
            ),
            React.createElement("div", { className: "flex gap-2" },
              React.createElement("button", {
                onClick: () => { if (window.confirm("Cancellare tutto?")) setRecords([]); },
                title: "Reset",
                className: "p-1.5 text-gray-600 hover:text-red-400"
              }, "↺"),
              React.createElement("button", {
                onClick: () => setShowConfig(!showConfig),
                title: "Impostazioni",
                className: `p-1.5 rounded-lg transition-colors ${showConfig ? 'bg-teal-500 text-white' : 'text-gray-500 bg-gray-900/50'}`
              }, "⚙")
            )
          ),

          /* Configurazione */
          showConfig && React.createElement("div", { className: "bg-gray-900/80 border border-gray-800 rounded-xl p-3" },
            React.createElement("div", { className: "grid grid-cols-2 gap-3 mb-2" },
              React.createElement("select", {
                value: shiftConfig.start,
                onChange: e => setShiftConfig(p => ({ ...p, start: e.target.value })),
                className: "bg-black border border-gray-700 rounded-lg p-2 text-xs font-bold text-white outline-none"
              },
                React.createElement("option", { value: "06:00" }, "MATTINA"),
                React.createElement("option", { value: "14:00" }, "POMERIGGIO")
              ),
              React.createElement("div", { className: "flex items-center bg-black border border-gray-700 rounded-lg px-2" },
                React.createElement("span", { className: "text-[9px] font-black text-gray-500 uppercase mr-2" }, "Target"),
                React.createElement("input", {
                  type: "number",
                  value: target,
                  onChange: e => setTarget(Number(e.target.value)),
                  className: "bg-transparent w-full text-xs font-bold text-teal-400 outline-none py-2"
                })
              )
            )
          ),

          /* Dashboard KPI */
          React.createElement("div", { className: "bg-gradient-to-br from-gray-900 to-black border border-gray-800 rounded-2xl p-4 shadow-xl" },
            React.createElement("div", { className: "flex justify-between items-start mb-3" },
              React.createElement("div", { className: "space-y-1" },
                React.createElement("div", { className: "text-[10px] font-black text-emerald-500/70 uppercase tracking-widest" }, "Residuo Target"),
                React.createElement("div", { className: "text-5xl font-black text-white tracking-tighter" }, live.isOver ? "0" : live.carsRem)
              ),
              React.createElement("div", { className: "text-right space-y-1" },
                React.createElement("div", { className: "text-[9px] font-black text-gray-600 uppercase" }, "Tempo Fine"),
                React.createElement("div", { className: "text-sm font-mono font-bold text-gray-300 bg-gray-800/50 px-2 py-1 rounded-lg" }, live.timeStr)
              )
            ),
            React.createElement("div", { className: "grid grid-cols-2 gap-2 pt-3 border-t border-gray-800/50" },
              React.createElement("div", { className: "text-center" },
                React.createElement("div", { className: "text-[9px] font-black text-gray-600 uppercase" }, "Ritmo"),
                React.createElement("div", { className: "text-xl font-black text-white" }, `${kpi.vOra} v/h`)
              ),
              React.createElement("div", { className: "text-center border-l border-gray-800/50" },
                React.createElement("div", { className: "text-[9px] font-black text-gray-600 uppercase" }, "Takt"),
                React.createElement("div", { className: "text-xl font-black text-white" }, `${kpi.takt} m`)
              )
            )
          ),

          /* Calcolo Fine Sequenza */
          React.createElement("div", { className: "bg-indigo-900/20 border border-indigo-500/30 rounded-2xl p-3" },
            React.createElement("div", { className: "flex items-center justify-between mb-3 px-1" },
              React.createElement("div", { className: "flex items-center gap-2" },
                React.createElement("span", { className: "text-[9px] font-black text-indigo-400 uppercase tracking-widest" }, "Calcolo Fine Sequenza")
              ),
              React.createElement("div", { className: "flex bg-black/40 rounded-lg p-0.5 border border-indigo-500/20" },
                ["GLAZING", "CH3"].map(tab =>
                  React.createElement("button", {
                    key: tab,
                    onClick: () => setActiveCalc(tab),
                    className: `px-3 py-1 text-[8px] font-black rounded-md transition-all ${
                      activeCalc === tab ? "bg-indigo-600 text-white" : "text-gray-500"
                    }`
                  }, tab)
                )
              )
            ),
            React.createElement("div", { className: "grid grid-cols-2 gap-2 mb-3" },
              React.createElement("input", {
                type: "number",
                placeholder: "Seq. Inizio",
                value: activeCalc === 'GLAZING' ? glazingData.start : ch3Data.start,
                onChange: e => activeCalc === 'GLAZING'
                  ? setGlazingData({ ...glazingData, start: e.target.value })
                  : setCh3Data({ ...ch3Data, start: e.target.value }),
                className: "bg-black/40 border border-indigo-500/20 rounded-xl p-2.5 text-xs font-bold text-white placeholder:text-gray-700 text-center outline-none"
              }),
              React.createElement("input", {
                type: "number",
                placeholder: "Seq. Fine",
                value: activeCalc === 'GLAZING' ? glazingData.end : ch3Data.end,
                onChange: e => activeCalc === 'GLAZING'
                  ? setGlazingData({ ...glazingData, end: e.target.value })
                  : setCh3Data({ ...ch3Data, end: e.target.value }),
                className: "bg-black/40 border border-indigo-500/20 rounded-xl p-2.5 text-xs font-bold text-white placeholder:text-gray-700 text-center outline-none"
              })
            ),
            currentPrediction
              ? React.createElement("div", { className: "grid grid-cols-2 gap-2" },
                  React.createElement("div", { className: "bg-black/60 rounded-xl p-2 border border-indigo-500/10" },
                    React.createElement("div", { className: "text-[8px] font-black text-indigo-400/60 uppercase text-center" }, "Tempo Stimato"),
                    React.createElement("div", { className: "text-lg font-black text-white text-center" }, currentPrediction.duration)
                  ),
                  React.createElement("div", { className: "bg-indigo-600/20 rounded-xl p-2 border border-indigo-500/40" },
                    React.createElement("div", { className: "text-[8px] font-black text-indigo-300 uppercase text-center" }, `Ora Prevista (${activeCalc})`),
                    React.createElement("div", { className: "text-lg font-black text-indigo-400 text-center" }, currentPrediction.eta)
                  )
                )
              : React.createElement("div", { className: "text-center text-[9px] font-bold text-gray-600 italic py-1" },
                  `Inserisci sequenze per ${activeCalc}`
                )
          ),

          /* Form Registrazione */
          React.createElement("div", { className: "bg-gray-900/40 border border-gray-800/50 rounded-2xl p-3" },
            React.createElement("form", { onSubmit: handleSubmit, className: "space-y-3" },

              React.createElement("div", { className: "grid grid-cols-2 gap-2" },
                React.createElement("input", {
                  type: "number",
                  required: true,
                  placeholder: "SEQ",
                  value: formData.seq,
                  onChange: e => setFormData({ ...formData, seq: e.target.value }),
                  className: "bg-black/60 border border-gray-800 rounded-xl p-3 text-xl font-mono font-black text-white text-center outline-none"
                }),
                React.createElement("input", {
                  type: "text",
                  required: true,
                  placeholder: "VETTURA",
                  value: formData.vettura,
                  onChange: e => setFormData({ ...formData, vettura: e.target.value.toUpperCase() }),
                  className: "bg-black/60 border border-gray-800 rounded-xl p-3 text-xl font-mono font-black text-white text-center outline-none uppercase"
                })
              ),

              /* ✅ Difetti / Note */
              React.createElement("textarea", {
                placeholder: "Difetti / Note (es. graffi, allineamento, controlli...)",
                value: formData.difetti,
                onChange: e => setFormData({ ...formData, difetti: e.target.value }),
                className: "bg-black/60 border border-gray-800 rounded-xl p-3 text-sm font-bold text-white w-full outline-none focus:border-teal-500/50",
                rows: 2
              }),

              React.createElement("div", { className: "grid grid-cols-2 gap-2" },
                React.createElement("div", { className: "flex bg-black/40 rounded-lg p-1 border border-gray-800/50" },
                  ['D74', 'L74'].map(m =>
                    React.createElement("button", {
                      key: m,
                      type: "button",
                      onClick: () => setFormData({ ...formData, modello: m }),
                      className: `flex-1 py-1.5 text-[10px] font-black rounded-md ${
                        formData.modello === m ? "bg-blue-600 text-white" : "text-gray-600"
                      }`
                    }, m)
                  )
                ),
                React.createElement("div", { className: "flex bg-black/40 rounded-lg p-1 border border-gray-800/50" },
                  ['BEV', 'MHEV'].map(a =>
                    React.createElement("button", {
                      key: a,
                      type: "button",
                      onClick: () => setFormData({ ...formData, alimentazione: a }),
                      className: `flex-1 py-1.5 text-[10px] font-black rounded-md ${
                        formData.alimentazione === a ? "bg-emerald-600 text-white" : "text-gray-600"
                      }`
                    }, a)
                  )
                )
              ),

              React.createElement("button", {
                type: "submit",
                className: "w-full py-4 rounded-xl font-black text-[11px] uppercase tracking-widest bg-teal-600 text-white"
              }, formData.id ? "AGGIORNA" : "SALVA RECORD"),

              formData.id && React.createElement("button", {
                type: "button",
                onClick: () => setFormData({ id: null, seq: '', vettura: '', modello: 'D74', alimentazione: 'BEV', difetti: '' }),
                className: "w-full py-3 rounded-xl font-black text-[10px] uppercase tracking-widest bg-gray-800 text-gray-200 border border-gray-700"
              }, "ANNULLA MODIFICA")
            )
          ),

          /* Storico + Import/Export */
          React.createElement("div", { className: "space-y-1.5" },
            React.createElement("div", { className: "flex justify-between items-center px-1" },
              React.createElement("span", { className: "text-[9px] font-black text-gray-700 uppercase italic" }, "Storico ordinato per SEQ"),
              React.createElement("div", { className: "flex gap-2" },
                React.createElement("input", { type: "file", ref: fileInputRef, onChange: handleImportExcel, className: "hidden", accept: ".xlsx,.xls,.csv" }),
                React.createElement("button", {
                  onClick: () => fileInputRef.current && fileInputRef.current.click(),
                  className: "text-[9px] font-black text-gray-500 uppercase hover:text-white"
                }, "IMPORT"),
                React.createElement("button", {
                  onClick: exportToExcel,
                  className: "text-[9px] font-black text-teal-500 uppercase hover:text-teal-400"
                }, "EXPORT XLSX")
              )
            ),

            React.createElement("div", { className: "space-y-1.5 max-h-[320px] overflow-y-auto pr-1 custom-scrollbar" },
              records.length > 0
                ? records.map(r =>
                    React.createElement("div", {
                      key: r.id,
                      onClick: () => setFormData({
                        ...r,
                        difetti: r.difetti || ""
                      }),
                      className: "bg-gray-900/30 border border-gray-800/40 p-2.5 rounded-xl flex items-center justify-between cursor-pointer hover:border-teal-500/30 transition-all"
                    },
                      React.createElement("div", { className: "flex items-center gap-3" },
                        React.createElement("span", { className: "text-lg font-mono font-black text-white" }, r.seq),
                        React.createElement("div", null,
                          React.createElement("div", { className: "text-[10px] font-black text-gray-200 uppercase leading-none" }, r.vettura),
                          React.createElement("div", { className: "flex gap-1 mt-1" },
                            React.createElement(Badge, { type: "model", value: r.modello }),
                            React.createElement(Badge, { type: "fuel", value: r.alimentazione })
                          ),
                          r.difetti
                            ? React.createElement("div", { className: "mt-1 text-[9px] font-bold text-amber-300/80" },
                                "Difetti: ",
                                React.createElement("span", { className: "text-amber-200/90" }, r.difetti)
                              )
                            : React.createElement("div", { className: "mt-1 text-[9px] font-bold text-gray-600 italic" },
                                "Nessun difetto"
                              )
                        )
                      ),
                      React.createElement("div", { className: "flex items-center gap-2" },
                        React.createElement("span", { className: "text-[8px] font-mono text-gray-600" }, r.oraRegistrazione),
                        React.createElement("button", {
                          onClick: (e) => { e.stopPropagation(); setRecords(records.filter(x => x.id !== r.id)); },
                          className: "px-2 py-1 text-[9px] font-black text-gray-700 hover:text-red-500"
                        }, "DEL")
                      )
                    )
                  )
                : React.createElement("div", { className: "text-center py-8 border-2 border-dashed border-gray-800/50 rounded-2xl text-[10px] font-black text-gray-700 uppercase tracking-widest" },
                    "Nessun record salvato"
                  )
            )
          )
        ),

        notification && React.createElement("div", {
          className: "fixed bottom-6 left-1/2 -translate-x-1/2 bg-teal-500 text-white px-6 py-2 rounded-full shadow-2xl font-black text-[10px] uppercase tracking-widest z-50"
        }, notification)
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>
</body>
</html>
